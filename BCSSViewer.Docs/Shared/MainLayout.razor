@using Microsoft.AspNetCore.Components.Routing;
@inherits LayoutComponentBase
@inject BcssService Bc

<MudScrollbar Color="var(--mud-palette-primary)" BorderRadius="20" Width="4" />

<MudLayout>
    <MudAppBar Style="background: var(--mud-palette-background) !important;" Dense="true" Elevation="0">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Primary" Edge="Edge.Start" OnClick="@(() => _open = !_open)" />
        <MudLink Style="color: var(--mud-palette-text-primary); user-select: none; cursor: pointer" Href="/" Underline="Underline.None"><b>BCSS</b></MudLink>
        <MudSpacer />
        <MudIconButton Icon="@Icons.Custom.Brands.GitHub" Color="Color.Primary" Href="https://github.com/CodeBeamOrg/BCSS" Target="_blank" />
        <MudToggleIconButton @bind-Toggled="_darkMode" Icon="@Icons.Material.Filled.DarkMode" ToggledIcon="@Icons.Material.Filled.LightMode" Color="Color.Primary" ToggledColor="Color.Primary" />
    </MudAppBar>

    <MudDrawer @bind-Open="@_open" Elevation="1" Variant="@DrawerVariant.Responsive" ClipMode="DrawerClipMode.Always">
        <MudNavMenu Bordered="true" Rounded="true">
            <MudNavGroup Title="Getting Started">
                <MudNavLink Match="NavLinkMatch.All" Href="gettingstarted/what">What is BCSS</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="gettingstarted/howitworks">How It Works</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="gettingstarted/installation">Installation</MudNavLink>
            </MudNavGroup>
            <MudNavGroup Title="Configuration">
                <MudNavLink Match="NavLinkMatch.All" Href="configuration/breakpoints">Breakpoints</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="configuration/spacing">Spacing</MudNavLink>
            </MudNavGroup>
            <MudNavGroup Title="Syntax">
                <MudNavLink Match="NavLinkMatch.All" Href="/syntax/basics">Basics and Usage</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/syntax/doubledash">Dash and Double Dash</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/syntax/unitmeasurement">Unit Measurement (Px, Rem)</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/syntax/prefixes">Prefixes (Breakpoints, Hover, Focus etc.)</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/syntax/customvalues">Custom Values</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/syntax/caseinsensitive">Case Insensitive</MudNavLink>
            </MudNavGroup>
            <MudNavGroup Title="Content">
                <MudNavLink Match="NavLinkMatch.All" Href="/usage/border">Borders</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/usage/dimension">Dimensions</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/usage/position">Position & Flex</MudNavLink>
                <MudNavLink Match="NavLinkMatch.All" Href="/usage/spacing">Spacing</MudNavLink>
            </MudNavGroup>
        </MudNavMenu>
    </MudDrawer>

    <MudMainContent>
        @Body
        <MudContainer Class="@Bc["mt-24"]">
            <MudDivider Class="mb-4" />
            <MudText Class="mb-4"><MudLink Href="https://codebeam.org" Target="_blank" Underline="Underline.Hover"><b>CodeBeam</b></MudLink> OpenSource @DateTime.Now.Year.</MudText>
        </MudContainer>
    </MudMainContent>
</MudLayout>

<MudThemeProvider @ref="_mudThemeProvider" Theme="_bcssTheme" @bind-IsDarkMode="_darkMode" />
<MudDialogProvider />
<MudSnackbarProvider />
<BlazorCssProvider />

@code {
    MudTheme _bcssTheme = new MudTheme()
        {
            Palette = new PaletteLight()
            {
                Primary = "#313B72",
                Secondary = "#F45B69",
                Tertiary = "#EEF4D4",
                TertiaryContrastText = "#000000",
            },

            PaletteDark = new PaletteDark()
            {
                Secondary = "#F45B69",
                Tertiary = "#EEF4D4",
                TertiaryContrastText = "#000000",
            },
        };

    MudThemeProvider? _mudThemeProvider;
    private bool _open;
    private bool _darkMode = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            _darkMode = await _mudThemeProvider?.GetSystemPreference();
            StateHasChanged();
        }
    }
}
